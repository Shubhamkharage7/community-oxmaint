
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Greetings, I am relatively new to Modbus and am seeking advice on best practices for using it effectively. Any tips or tricks on optimizing the usage of Modbus would be greatly appreciated. Thank you in advance.">
    <meta name="keywords" content="modbus best practices, modbus optimization tips, effective modbus usage, modbus tips and tricks, modbus optimization strategies, improving modbus performance, modbus">
    <meta name="author" content="oxmaint">
    
    <link rel="canonical" href="https://community.oxmaint.com/discussion-forum/best-practices-for-using-modbus-tips-and-tricks-for-effective-optimization">
    <title>Best Practices for Using Modbus: Tips and Tricks for Effective Optimization | Oxmaint Community</title>
    <link rel="shortcut icon" href="./../assets/img/favicon.png" />
    <link rel="stylesheet" href="./../assets/css/plugins.css" />
    <link rel="stylesheet" href="./../assets/css/style.css" />
    <link rel="stylesheet" href="./../assets/css/colors/purple.css" />
    
    <!-- og or twitter tags -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="Best Practices for Using Modbus: Tips and Tricks for Effective Optimization | Oxmaint Community">
    <meta property="og:description" content="Greetings, I am relatively new to Modbus and am seeking advice on best practices for using it effectively. Any tips or tricks on optimizing the usage of Modbus would be greatly appreciated. Thank you in advance.">
    <meta property="og:url" content="https://community.oxmaint.com/discussion-forum/best-practices-for-using-modbus-tips-and-tricks-for-effective-optimization">
    <meta property="og:site_name" content="Oxmaint">
    <meta property="og:image" content="https://community.oxmaint.com/assets/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Best Practices for Using Modbus: Tips and Tricks for Effective Optimization | Oxmaint Community">
    <meta name="twitter:description" content="Greetings, I am relatively new to Modbus and am seeking advice on best practices for using it effectively. Any tips or tricks on optimizing the usage of Modbus would be greatly appreciated. Thank you in advance.">
    <meta name="twitter:image" content="https://community.oxmaint.com/assets/img/favicon.png">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y6M0T9NLP4"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-Y6M0T9NLP4');
    </script>

    <!-- Structured Data (Schema.org) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://community.oxmaint.com/discussion-forum/best-practices-for-using-modbus-tips-and-tricks-for-effective-optimization"
      },
      "headline": "Best Practices for Using Modbus: Tips and Tricks for Effective Optimization",
      "description": "Greetings, I am relatively new to Modbus and am seeking advice on best practices for using it effectively. Any tips or tricks on optimizing the usage of Modbus would be greatly appreciated. Thank you in advance.",
      "author": {
        "@type": "Person",
        "name": "Strickland701"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Oxmaint",
        "logo": {
          "@type": "ImageObject",
          "url": "https://community.oxmaint.com/assets/img/favicon.png"
        }
      },
      "datePublished": "2024-07-07",
      "image": "https://community.oxmaint.com/assets/img/favicon.png"
    }
    </script>

    

<link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
<script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" defer></script>
<link rel="stylesheet" href="./../assets/css/home.css"/>
</head>
<body>
    <div class="content-wrapper bg-gray">
        <?php include "../include/header.php" ?>
        <!-- /header -->
        <div class="container my-5">
            

            <div class="bg-primary card p-4 mb-4">
                <h1 class="text-white">Best Practices for Using Modbus: Tips and Tricks for Effective Optimization</h1>
                <div class="d-flex justify-content-between">
                    <ul class="post-meta text-white fs-15 mb-4">
                        <li class="post-date"><i class="uil uil-calendar-alt"></i><span>07-07-2024</span></li>
                        <li class="post-author"><i class="uil uil-user"></i><span>Strickland701</span></li>
                        <li class="post-comments"><i class="uil uil-comment-alt-dots"></i><span>21 comments</span></li>
                        <li class="post-seen"><i class="uil uil-eye"></i><span id="counter">1226</span></li>
                        <li class="post-like"><i class="uil uil-thumbs-up" id="likeButton"></i><span id="likeCount">238</span></li>
                    </ul>
                </div>
                <div class="card p-4">
                    <h3>Question:</h3>
                    <p>Greetings, I am relatively new to Modbus and am seeking advice on best practices for using it effectively. Any tips or tricks on optimizing the usage of Modbus would be greatly appreciated. Thank you in advance.</p>
                </div>
            </div>

            <div class="row custom-row">
                <div class="col-lg-9 mx-auto mb-5">
                    <div>
                        <div class="p-4">
                            <h3 class="text-primary">Top Replies</h3>
                            
        <div class="bg-white p-3 rounded mb-3">
            <p>Learning ModBus, Ethernet/IP, ASCII, and other communication protocols is akin to mastering a language. Understanding the basics is crucial, such as input and output bits, input and output words. Similar to learning a new language, it's important to know when to ask a question versus making a statement.

Think of addresses as cells on a spreadsheet. You may want to read data from cells A1 to A12, while writing data to cells B13 to B15. To deepen your understanding, check out Red Lion's Modbus primer, available at the following link: https://support.redlion.net/hc/en-us/articles/360021391791-Modbus-Primer.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>08-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>JeffKiper</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>The Pareto principle states that in 80% of Modbus setups, it will work without much effort, requiring only 20% of your time. However, in the remaining 20% of setups, inconsistencies may arise, leading you to spend 80% of your time troubleshooting.

To streamline your Modbus experience, consider using a Modbus program that can run on various operating systems and functions as both a Modbus Slave (Server) and Master (Client). It is recommended to view values in hexadecimal format for easier debugging.

Familiarize yourself with the Modbus protocol by referring to the technical documentation provided by The Modbus Organization. Be mindful that prefix digits are not part of the address, and learn to interpret each bit in a 16-bit integer as signed or unsigned.

It is crucial to understand the conversion between hexadecimal and decimal representations and the significance of byte order (LSB- and MSB-first). Despite standards, different implementations may vary in numbering conventions, so adapt accordingly when making Modbus requests.

Keep detailed records of your queries in forums, providing comprehensive information about your setup and any issues encountered. Lastly, never assume that all Modbus implementations follow protocol standards; validate data integrity by monitoring values sent and received.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>09-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>drbitboy</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>Just like how English is spoken by people in the US, Australia, New Zealand, Canada, England, and other countries, Modbus is a widely used protocol in the field of industrial automation. However, there are subtle differences in its implementation that can lead to challenges, as highlighted by drbitboy. In my extensive experience with Modbus projects, I have found that field adjustments are often necessary to ensure smooth operation. While the Pareto Principle suggests that 80% of problems can be solved with 20% of the effort, I believe that fine-tuning Modbus systems can require more attention to detail.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>09-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>Ken Moore</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>We extend our gratitude to everyone for their assistance.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>09-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>Strickland701</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>When it comes to protocol design, Modbus stands out as one of the simplest options available. It efficiently transmits bits and raw 16-bit words without specifying the type of integer being used. However, it lacks clarity on how 32-bit data types should be transmitted. If you're looking for a straightforward protocol that minimizes byte usage, Modbus is a solid choice.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>09-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>lfe</span></li>
            </ul>
        </div>
        
                        </div>
                        <div class="p-4">
    <h3 class="text-primary">
        <a href="#" class="toggle-more-replies" style="text-decoration: underline; color: #1a73e8; cursor: pointer;">More Replies →</a>
    </h3>
    <div class="more-replies-content" style="display: none;">
                            
        <div class="bg-white p-3 rounded mb-3">
            <p>One major challenge to keep in mind is the timing and word ordering when transferring 32-bit values, especially when dealing with vendors who do not adhere to the specifications. For in-depth discussions about Modbus, control.com offers a wealth of posts covering various topics.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>10-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>Peter Nachtwey</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>Working with Modbus can be an enjoyable experience, but its true potential is unlocked when paired with compatible hardware. Each individual approaches the technology in their own unique way, making it a customizable and versatile tool for various applications.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>11-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>padees</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>I decided to purchase affordable modbus modules from Amazon, which I utilized to gain a better understanding of the MODBUS protocol. This hands-on experience helped me to enhance my knowledge of MODBUS and its functionalities.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>11-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>mikeexplorer</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>Are you considering using Modbus for connecting hardware to a PLC or hardware to a PC? While Modbus has been a reliable transmission protocol for years, it may not be the best option for communication between two PCs or between a PLC and a PC or HMI. There are more advanced and efficient methods available for these setups.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>11-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>mad4x4</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>Dealing with Modbus protocols can prove to be a challenging task, as I experienced firsthand on a project monitoring switch gear status via Modbus. The initial testing on low voltage gear went smoothly, but upon field deployment, issues arose due to varying gear models, resulting in changes to the Modbus tables. Additionally, a byte swap was necessary for the medium voltage gear from the same vendor. This highlights the complexities and frustrations that can arise when working with Modbus communications.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>12-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>Ken Moore</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>Similar to a USB connection, serial Modbus connections require polarity swapping multiple times to ensure functionality. If zero-based addressing is chosen, the device will automatically switch to one-based addressing. Remember to also swap bytes if you are swapping words. Modbus communication can be compared to the unpredictability of the wild west.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>12-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>TheWaterboy</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>When working with Modbus addresses, it is common to find that the manufacturer's listed addresses are typically one higher than the actual address needed to communicate with the device. For instance, the CLICK PLC Tag Browser may list DS1 as Modbus address 400001, but in reality, you would need to request address "0" to read this register accurately. 

When dealing with 32-bit floating point values, precision is key. Even a small address error of 1 can affect the accuracy of the floating point value. To effectively read and write Modbus RTU/TCP addresses, consider using the QModMaster app, which is a reliable and free tool.

Keep in mind that 32-bit values are presented with the high word first, so it is essential to swap the words when parsing them with libraries like Node.JS Buffer.readFloatBE(). This process differs from Big Endian vs Little Endian encoding.

For easy visualization and verification of floating point values, utilize Greg Stoll's conversion app. Additionally, refer to the Modbus memory map table provided by device manufacturers in the device manual. This table aligns settings and functions with the corresponding Modbus function codes and addresses for seamless communication. Good luck!</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>12-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>ryangriggs</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>In the realm of Modbus communication, it is important to remember that consistency between vendors is not always guaranteed with 32-bit values. While it may seem like a given, it is crucial to remain vigilant and open-minded when working with different Modbus systems. Staying adaptable and flexible in your approach can make navigating these inconsistencies much easier.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>12-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>TheWaterboy</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>I collaborated with a prominent manufacturer to optimize their products. The company's owner, a savvy technical expert, sought my input on system improvements. I recommended consolidating their ModBus stacks into a single vendor-provided version, as they were utilizing multiple incompatible versions causing data alignment issues across various products. After just 4 hours of work with spreadsheets, we successfully aligned the data across 10 different products. This integration resolved communication barriers between product groups and facilitated the implementation of Ethernet/IP, resulting in a smoother operation with only minor bug fixes needed. One notable issue was Byte swapping, which was swiftly addressed.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>12-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>JeffKiper</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>Ethernet/IP can be a source of confusion due to the variety of protocols used by Rockwell under this name. Different PLCs like PLC5, Micrologix, CLX, and Micro800 have their own unique Ethernet/IP protocols. Rockwell categorizes all these protocols under the umbrella term of Ethernet/IP, despite the differences between them. Even the CLX protocol, which may seem standard, differs slightly from the one used by Omron.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>12-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>lfe</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>Rockwell utilizes CSP for PLC5 and PCCC for Micrologix and SLC, which essentially involves communication protocols such as DF1 over Ethernet, Ethernet/IP, CIP Ethernet, and more. These protocols are commonly used in industrial automation systems for efficient data exchange and control.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>12-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>JeffKiper</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>The arrangement of A and B signal lines on Modbus RTU RS485 is not standardized, and neither are the RS485 pinouts across different manufacturers and connectors. When using Modbus TCP, it is important to determine whether the communication protocol is TCP or RTU over TCP, which may not always be clearly specified. The register offset and supported Modbus functions can also differ, even among products from the same manufacturer due to varying Modbus mappings in different firmware versions or devices (such as ABB VFDs with different register mappings based on the ACS model). The number of words and bits that can be read or written in a Modbus query may vary, as there is a maximum limit, but not all devices support the maximum register length for messages. It is unwise to assume that all registers are readable when there are gaps in the data. Some manufacturers may have spare or free Modbus registers mapped even without data, while others may require different Modbus queries to access specific registers that are not contiguous with the rest of the data. Byte order is not standard for data that is not 16-bits (such as Reals and double integer bytes), requiring manipulation on the receiving end. The bit order within words can also vary based on endianess.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>12-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>Lare</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>One area of disagreement lies in the interoperability of Modbus between different vendors. It's important to remember that "always" may not apply in this context, making it easier to navigate. While I agree with this point, I'm unable to edit my initial post as the edit window has closed. It's unclear why this limitation was put in place.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>12-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>ryangriggs</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>When it comes to Modbus RTU, the physical connection used can vary, with common options being RS232, RS422, or RS485. Regardless of the connection type, Modbus RTU always uses 8 data bits to transmit the pure binary value rather than its ASCII representation. It's important to note that Modbus RTU over TCP is not considered a standard protocol.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>12-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>lfe</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>ryangriggs pointed out a common issue with Modbus addresses provided by manufacturers, where the addresses are actually one greater than the address you need to request. This discrepancy can cause confusion, especially when dealing with the difference between registers and addresses in Modbus communication. It is essential to understand that registers are usually 1 based, while addresses are 0 based, leading to potential misunderstandings.

To avoid confusion, it is recommended to check if your software can automatically adjust the values for you or ensure consistency between the values on your side and the PLC/device side. Additionally, Modbus natively supports 16 and 32-bit values, but not 64-bit values. If you encounter a 64-bit value situation, you may need to scan 4 words and piece them together to obtain the desired data.

Moreover, for handling strings in Modbus, each character is typically represented by one byte (8-bits), and multiple registers may need to be read to retrieve the complete string. It is important to define the length of the string correctly to avoid issues. By paying attention to these details and ensuring proper configuration, you can prevent confusion and ensure accurate data transmission in Modbus communication.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>12-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>nicherbert</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>When considering the use of Modbus, it is important to understand its intended purpose. Modbus is commonly used to establish connections between hardware devices, such as PLCs and PCs. However, when it comes to transmitting data between two PCs or between a PLC and an HMI, there are more efficient and modern alternatives available. While Modbus has been a reliable solution for many years, it is considered legacy technology. In the context of collecting data from IO in oilfields, there may be more suitable options to consider.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>12-07-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>Strickland701</span></li>
            </ul>
        </div>
        
                        </div>
                    <div class="no-replies-message" style="display: none; color: gray;">
        No More Replies.
    </div>
        
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 outer-container">
        <!-- Related Topics -->
    <?php include "./related-topic.php" ?>
    </div>
            </div>
             <!-- cta button -->
        <?php include "./cta.php" ?>

            <!-- FAQ Section -->
            <div class='my-5'><h3 class='faq-title text-primary mb-4'>Frequently Asked Questions (FAQ)</h3>
<div class='faq-item bg-light p-4 rounded shadow-sm mb-3'>
<h4 class='text-dark'>FAQ: FAQs:</h4>
<p class='text-muted'><strong>Answer:</strong> 1. What are some best practices for using Modbus effectively?
- Utilize proper error checking mechanisms to ensure data integrity.
- Implement appropriate timeout settings to handle communication delays.
- Optimize data mapping to avoid unnecessary reads/writes.</p>
</div>
<div class='faq-item bg-light p-4 rounded shadow-sm mb-3'>
<h4 class='text-dark'>FAQ: 2. How can I optimize the usage of Modbus?</h4>
<p class='text-muted'><strong>Answer:</strong> - Minimize the number of requests and batch data transfers when possible.
- Use proper data types to ensure efficient data transmission.
- Consider using Modbus TCP/IP for faster communication over Ethernet.</p>
</div>
<div class='faq-item bg-light p-4 rounded shadow-sm mb-3'>
<h4 class='text-dark'>FAQ: 3. Are there any specific tips for beginners using Modbus?</h4>
<p class='text-muted'><strong>Answer:</strong> - Start by understanding the Modbus protocol and data model.
- Use reliable libraries or software tools for Modbus implementation.
- Test communication thoroughly to identify and resolve any issues early on.</p>
</div>
</div>
        </div>
        <?php include "./footer-banner.php" ?>

        <!-- /footer -->
        <?php include "../include/footer.php" ?>

        <!-- Lazy load for faster image loading -->
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                const lazyImages = document.querySelectorAll('img[loading="lazy"]');
                lazyImages.forEach(img => {
                    img.src = img.dataset.src;
                });
            });
        </script>

        <script src="like-view-counter.js"></script>
    </div>
<script>
document.addEventListener("DOMContentLoaded", () => {
    function initializeToggleFunctionality() {
        const toggleLink = document.querySelector(".toggle-more-replies");
        const moreRepliesContent = document.querySelector(".more-replies-content");
        const noRepliesMessage = document.querySelector(".no-replies-message");

        if (!toggleLink || !moreRepliesContent || !noRepliesMessage) {
            console.error("Required elements not found. Ensure the correct class names are used.");
            console.log({
                toggleLink,
                moreRepliesContent,
                noRepliesMessage,
            });
            return;
        }

        const hasReplies = Array.from(moreRepliesContent.children).some(
            (child) => child.nodeType === Node.ELEMENT_NODE
        );

        if (hasReplies) {
            noRepliesMessage.style.display = "none";
        } else {
            noRepliesMessage.style.display = "block";
            toggleLink.style.display = "none";
            return;
        }

        toggleLink.addEventListener("click", (event) => {
            event.preventDefault();
            const isHidden = getComputedStyle(moreRepliesContent).display === "none";
            moreRepliesContent.style.display = isHidden ? "block" : "none";
            toggleLink.textContent = isHidden ? "Hide More Replies" : "More Replies →";
        });
    }

    initializeToggleFunctionality();

    const observer = new MutationObserver(() => {
        const toggleLink = document.querySelector(".toggle-more-replies");
        const moreRepliesContent = document.querySelector(".more-replies-content");

        if (toggleLink && moreRepliesContent) {
            initializeToggleFunctionality();
            observer.disconnect();
        }
    });

    observer.observe(document.body, { childList: true, subtree: true });
});
</script>
</body>
</html>
