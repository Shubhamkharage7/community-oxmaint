
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Greetings to all readers! While this is my debut post, I have frequented this platform in search of solutions to various issues, as we all do. Currently, I am exploring the capabilities of Cimplicity 2022, specifically in utilizing Classes/Objects and corresponding Graphic Templates. I apologize for the extensive details">
    <meta name="keywords" content="cimplicity 2022, graphics challenges, embedded classes, graphic templates, cimplicity classes, cimplicity objects, cimplicity reserved variables, opc-ua server, tank object, composite members, address building process, graphic templates issues">
    <meta name="author" content="oxmaint">
    
    <link rel="canonical" href="https://community.oxmaint.com/discussion-forum/optimizing-cimplicity-2022-overcoming-challenges-with-graphics-and-embedded-classes">
    <title>Optimizing Cimplicity 2022: Overcoming Challenges with Graphics and Embedded Classes | Oxmaint Community</title>
    <link rel="shortcut icon" href="./../assets/img/favicon.png" />
    <link rel="stylesheet" href="./../assets/css/plugins.css" />
    <link rel="stylesheet" href="./../assets/css/style.css" />
    <link rel="stylesheet" href="./../assets/css/colors/purple.css" />
    
    <!-- og or twitter tags -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="Optimizing Cimplicity 2022: Overcoming Challenges with Graphics and Embedded Classes | Oxmaint Community">
    <meta property="og:description" content="Greetings to all readers! While this is my debut post, I have frequented this platform in search of solutions to various issues, as we all do. Currently, I am exploring the capabilities of Cimplicity 2022, specifically in utilizing Classes/Objects and corresponding Graphic Templates. I apologize for the extensive details">
    <meta property="og:url" content="https://community.oxmaint.com/discussion-forum/optimizing-cimplicity-2022-overcoming-challenges-with-graphics-and-embedded-classes">
    <meta property="og:site_name" content="Oxmaint">
    <meta property="og:image" content="https://community.oxmaint.com/assets/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Optimizing Cimplicity 2022: Overcoming Challenges with Graphics and Embedded Classes | Oxmaint Community">
    <meta name="twitter:description" content="Greetings to all readers! While this is my debut post, I have frequented this platform in search of solutions to various issues, as we all do. Currently, I am exploring the capabilities of Cimplicity 2022, specifically in utilizing Classes/Objects and corresponding Graphic Templates. I apologize for the extensive details">
    <meta name="twitter:image" content="https://community.oxmaint.com/assets/img/favicon.png">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y6M0T9NLP4"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-Y6M0T9NLP4');
    </script>

    <!-- Structured Data (Schema.org) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://community.oxmaint.com/discussion-forum/optimizing-cimplicity-2022-overcoming-challenges-with-graphics-and-embedded-classes"
      },
      "headline": "Optimizing Cimplicity 2022: Overcoming Challenges with Graphics and Embedded Classes",
      "description": "Greetings to all readers! While this is my debut post, I have frequented this platform in search of solutions to various issues, as we all do. Currently, I am exploring the capabilities of Cimplicity 2022, specifically in utilizing Classes/Objects and corresponding Graphic Templates. I apologize for the extensive details",
      "author": {
        "@type": "Person",
        "name": "nicherbert"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Oxmaint",
        "logo": {
          "@type": "ImageObject",
          "url": "https://community.oxmaint.com/assets/img/favicon.png"
        }
      },
      "datePublished": "2024-10-21",
      "image": "https://community.oxmaint.com/assets/img/favicon.png"
    }
    </script>

<link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
<script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" defer></script>
<link rel="stylesheet" href="./../assets/css/home.css"/>
</head>
<body>
    <div class="content-wrapper bg-gray">
        <?php include "../include/header.php" ?>
        <!-- /header -->
        <div class="container my-5">
            

            <div class="bg-primary card p-4 mb-4">
                <h1 class="text-white">Optimizing Cimplicity 2022: Overcoming Challenges with Graphics and Embedded Classes</h1>
                <div class="d-flex justify-content-between">
                    <ul class="post-meta text-white fs-15 mb-4">
                        <li class="post-date"><i class="uil uil-calendar-alt"></i><span>21-10-2024</span></li>
                        <li class="post-author"><i class="uil uil-user"></i><span>nicherbert</span></li>
                        <li class="post-comments"><i class="uil uil-comment-alt-dots"></i><span>4 comments</span></li>
                        <li class="post-seen"><i class="uil uil-eye"></i><span id="counter">402</span></li>
                        <li class="post-like"><i class="uil uil-thumbs-up" id="likeButton"></i><span id="likeCount">316</span></li>
                    </ul>
                </div>
                <div class="card p-4">
                    <h3>Question:</h3>
                    <p>Greetings to all readers! While this is my debut post, I have frequented this platform in search of solutions to various issues, as we all do. Currently, I am exploring the capabilities of Cimplicity 2022, specifically in utilizing Classes/Objects and corresponding Graphic Templates. I apologize for the extensive details in this post, but they are essential for addressing the challenges hindering my progress.

The primary hurdle I am facing involves defining multiple Classes, some of which incorporate embedded (Composite Members) classes within them. Throughout this process, several obstacles have arisen, prompting me to seek effective workarounds. However, at each step, I encounter what appear to be glitches in Cimplicity or gaps in my understanding of the tool. Although I have consulted the documentation, the provided resources do not seem comprehensive enough to achieve what should theoretically be possible.

One of the initial issues I encountered pertained to the CIMPLICITY reserved variables. Our implementation involves an OPC-UA server, and we aim to construct the address by assigning parameters accordingly. Within this context, three key variables are under scrutiny: $ADDRESS, $OBJECT, and $ID.

When creating a Tank Object named TANK1, a series of points are generated as follows:
[PATH].TANK1.LEVEL
[PATH].TANK1.HI_ALARM
[PATH].TANK1.INLET.STS_OPEN
[PATH].TANK1.INLET.STS_CLOSED
[PATH].TANK1.INLET.CMD_OPEN
[PATH].TANK1.INLET.CMD_CLOSED
[PATH].TANK1.OUTLET.STS_OPEN
[PATH].TANK1.OUTLET.STS_CLOSED
[PATH].TANK1.OUTLET.CMD_OPEN
[PATH].TANK1.OUTLET.CMD_CLOSED

In my exploration, I discovered that while $OBJECT and $ID function effectively in most scenarios, challenges arise when dealing with composite members. To address this, I leveraged the $ADDRESS variable within the object's parameter definition, ultimately streamlining the OPC address building process.

Regarding graphics, we craft Class templates for independent utilization. However, issues arise when attempting to incorporate these templates into other graphics, particularly involving embedded classes. Despite setting the $OBJECT parameter and ensuring its public status, complications arise when handling composite members within graphic templates.

In conclusion, despite my efforts to address these challenges through scripting, the documentation's limitations hinder progress. If any readers have successfully navigated similar hurdles involving embedded classes and graphics in Cimplicity 2022, I welcome any insights or solutions you may offer. It is my hope that this discussion resonates with others who have encountered comparable obstacles.</p>
                </div>
            </div>

            <div class="row custom-row">
                <div class="col-lg-9 mx-auto mb-5">
                    <div>
                        <div class="p-4">
                            <h3 class="text-primary">Top Replies</h3>
                            
        <div class="bg-white p-3 rounded mb-3">
            <p>I am uncertain if there is a more efficient method, but this is the process I have followed. While it would be ideal if the built-in method functioned correctly, here is what I implemented. 

I altered my OPC address using {$OBJECT} instead of {$ADDRESS}, then directly adding the composite member name at the end. This approach functions both independently and when integrated. 

On the graphics aspect, I omitted the $ADDRESS parameter and solely utilized $OBJECT. I established the $OBJECT public variables on the primary screen/object as typically instructed. In standalone graphics instances, Cimplicity automatically allocated the value. However, in embedded scenarios, I executed an OPEN SCREEN event to allocate the $OBJECT variable of the object on the screen. 

This process was somewhat complex, requiring the use of obsolete functions as the newer functions did not seem to allow access easily (referencing the weak online help documentation). By utilizing CimObject's and cimGetScriptOwner(), I accessed the GetObject() function to select it by name. To execute this successfully, comprehensive knowledge of the object hierarchy on the screen is necessary, with all objects appropriately named (found under General -> Name). 

When dealing with grouped items, the process involves first obtaining the group object by name and subsequently acquiring the desired object within that group (also by name). For instance, if I have a group named Parameters containing P1, P2, P3, etc., within the script running on the main screen, the code would resemble the following:

```vb
Dim oObject As GefObjectVariable
Dim cObject As CimObject

Set oObject = CimGetObject.GetVariable("$OBJECT") 'Automatically assigned variable by Cimplicity
Set cObject = CimGetScriptOwner() 'Alternatively, could be CimGetRootObject()

cObject.GetObject("Parameters").GetObject("P1").GetVariable("$OBJECT").Value = oObject.Value
```

It is unclear if this is the intended method, but this is the sole way I have discovered to effectively execute this task. This process is meticulous and requires careful attention to detail. For those seeking assistance, refer to the General tab of the object and locate the name. For grouped objects, utilize the Group tab to navigate the object hierarchy. Experienced Cimplicity programmers, please share your insight to either validate this approach or suggest a more efficient method.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>22-10-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>nicherbert</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>Are you looking to utilize a class object with graphics in your project? Start by creating a screen file to house the graphic object and assign a variable such as "$Object" with the option of making it "Public" and giving it a generic name like "Tank". Remember to save your work. Then, input the screen file path and name in the class's general tab under Graphics file. Generate a class object based on this class. In another screen, go to the drawing menu and insert the class object. Choose the specific class object you want to display. The graphic will appear on the screen with the "$Object" variable automatically linked to the object's ID. From now on, manipulate the "$Object" variable instead of the object's name. If you have various graphics for similar objects, you can store them in the same screen file. Once you add a class object, simply right-click on the graphic to select from different optional graphics available, such as TankType1 or TankType2.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>23-10-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>JunQ</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>JunQ recommended creating a screen file to assign a graphic object to a class object. By defining a general variable like "$Object" and specifying the object type (e.g. "Tank" under the "Public" setting), the graphic can be easily displayed on the screen. In the class tab, the file path and name must be filled out to link the graphic file. 

When dealing with nested class objects, the "$OBJECT" variable may encounter issues, particularly when used in the class object definition. The variable may not just represent the object instance ID, but also the composite member name (e.g. Tank1.Valve1). This can complicate tasks such as building OPC addresses or tag names.

To address this issue, one workaround is to define the object using the reserved word $ADDRESS instead of $OBJECT. This method works smoothly for composite members, but may require a script for standalone objects with graphics. Cimplicity's limitation on multiple replacement steps can make it challenging to update the path correctly.

In summary, dealing with nested class objects and composite members can present challenges in managing variables such as $OBJECT and $ADDRESS. Careful consideration and potential scripting may be needed to navigate these complexities effectively.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>24-10-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>nicherbert</span></li>
            </ul>
        </div>
        
        <div class="bg-white p-3 rounded mb-3">
            <p>In order to pass a variable value from a group level to its child with the same variable, scripting appears to be the only solution. This can be accomplished within Cimedit by using a smart object event for permanent assignment, or in Cimview during the opening screen or other events. Below is a code snippet for reference, utilizing the "item" property to iterate through child objects without worrying about their names:

```
Option Compare Text
Option CStrings On

Sub OnScreenOpen()
    On Error GoTo errMsg
    Dim grpObj As GefObject
    
    Set grpObj = CimGetScreen.Object.Objects.Item("Parameters")
    
    For i = 0 To grpObj.Objects.count-1
        Set objVar = CimGetObject.Objects.Item(i).GetVariable("$Object")
        
        If IsNull(objVar) Then
            GoTo Skip
        Else
            grpObj.Objects.Item(i).GetVariable("$Object").Value = grpObj.GetVariable("$Object").Value
        End If
        
    Skip:
    Next
    
    GoTo Done
    
errMsg:
    MsgBox "Line: " & Erl & "\n" & Error(Err)
    Err = -1
    
Done:
    CimGetScreen.refresh false
End Sub
```

This script effectively transfers variable values within a group hierarchy, ensuring seamless communication between parent and child objects.</p>
            <ul class="post-meta mb-0">
                <li class="post-date"><i class="uil uil-calendar-alt"></i><span>25-10-2024</span></li>
                <li class="post-author"><i class="uil uil-user"></i><span>JunQ</span></li>
            </ul>
        </div>
        
                        </div>
                        <div class="p-4">
    <h3 class="text-primary">
        <a href="#" class="toggle-more-replies" style="text-decoration: underline; color: #1a73e8; cursor: pointer;">More Replies →</a>
    </h3>
    <div class="more-replies-content" style="display: none;">
       
    </div>
    <div class="no-replies-message" style="display: none; color: gray;">
        No More Replies.
    </div>
</div>
                    <div class="no-replies-message" style="display: none; color: gray;">
        No More Replies.
    </div>
        
                        </div>
                    </div>
                <div class="col-lg-3 outer-container">
                    <!-- Related Topics -->
                    <?php include "./related-topic.php" ?>
                </div>
            </div>
            <!-- </div> -->
            <!-- cta button -->
            <?php include "./cta.php" ?>

            <!-- FAQ Section -->
            <div class='my-5'><h3 class='faq-title text-primary mb-4'>Frequently Asked Questions (FAQ)</h3>
<div class='faq-item bg-light p-4 rounded shadow-sm mb-3'>
<h4 class='text-dark'>FAQ: 1.  What are some of the key challenges faced when working with embedded classes in Cimplicity 2022?</h4>
<p class='text-muted'><strong>Answer:</strong> Answer: The challenges when dealing with embedded classes in Cimplicity 2022 can include issues with defining multiple classes, handling composite members, and difficulties in incorporating class templates into graphics.</p>
</div>
<div class='faq-item bg-light p-4 rounded shadow-sm mb-3'>
<h4 class='text-dark'>FAQ: 2.  How can the CIMPLICITY reserved variables ($ADDRESS, $OBJECT, $ID) be effectively utilized in setting up OPC addresses for objects like tanks in Cimplicity 2022?</h4>
<p class='text-muted'><strong>Answer:</strong> Answer: The $ADDRESS variable can be leveraged within the object's parameter definition to streamline the OPC address building process, especially when dealing with composite members.</p>
</div>
<div class='faq-item bg-light p-4 rounded shadow-sm mb-3'>
<h4 class='text-dark'>FAQ: 3.  What are some common obstacles faced when trying to incorporate class templates into graphics, particularly involving embedded classes in Cimplicity 2022?</h4>
<p class='text-muted'><strong>Answer:</strong> Answer: Challenges may arise when setting the $OBJECT parameter and handling composite members within graphic templates, despite ensuring their public status.</p>
</div>
</div>
        </div>
        <?php include "./footer-banner.php" ?>

        <!-- /footer -->
        <?php include "../include/footer.php" ?>

        <script src="like-view-counter.js"></script>
    </div>
<script>
document.addEventListener("DOMContentLoaded", () => {
    function initializeToggleFunctionality() {
        const toggleLink = document.querySelector(".toggle-more-replies");
        const moreRepliesContent = document.querySelector(".more-replies-content");
        const noRepliesMessage = document.querySelector(".no-replies-message");

        if (!toggleLink || !moreRepliesContent || !noRepliesMessage) {
            console.error("Required elements not found. Ensure the correct class names are used.");
            console.log({
                toggleLink,
                moreRepliesContent,
                noRepliesMessage,
            });
            return;
        }

        const hasReplies = Array.from(moreRepliesContent.children).some(
            (child) => child.nodeType === Node.ELEMENT_NODE
        );

        if (hasReplies) {
            noRepliesMessage.style.display = "none";
        } else {
            noRepliesMessage.style.display = "block";
            toggleLink.style.display = "none";
            return;
        }

        toggleLink.addEventListener("click", (event) => {
            event.preventDefault();
            const isHidden = getComputedStyle(moreRepliesContent).display === "none";
            moreRepliesContent.style.display = isHidden ? "block" : "none";
            toggleLink.textContent = isHidden ? "Hide More Replies" : "More Replies →";
        });
    }

    initializeToggleFunctionality();

    const observer = new MutationObserver(() => {
        const toggleLink = document.querySelector(".toggle-more-replies");
        const moreRepliesContent = document.querySelector(".more-replies-content");

        if (toggleLink && moreRepliesContent) {
            initializeToggleFunctionality();
            observer.disconnect();
        }
    });

    observer.observe(document.body, { childList: true, subtree: true });
});
</script>
</body>
</html>
